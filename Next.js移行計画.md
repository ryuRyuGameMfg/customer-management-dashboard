# 顧客管理ビュー Next.js/Tailwind 化計画

## ゴール
- 既存 `index.html` の機能（Markdown顧客データ表示・テンプレートコピー機能）を Next.js + Tailwind CSS で再構築。
- データソースは現行と同じ Markdown ファイルを利用しつつ、将来のデータ拡張に備えた構成とする。
- 最終的に `npm run dev -- --port 3002` でローカルサーバーを起動できる状態を提供。

## フェーズ構成

### 1. プロジェクトセットアップ
- `create-next-app` を利用し `app` ルーター前提のNext.jsプロジェクトを `04 顧客管理/next-app/` に作成。
- Tailwind CSS, TypeScript, ESLint, Prettier を初期導入。
- `顧客管理データ.md`, `メッセージテンプレート.md` を `public/data/` へ配置し、Markdown形式を維持。

### 2. データアクセス層の整備
- `lib/markdown.ts` などを作成し、Markdownからテーブルデータ・テンプレートJSONを読み取るユーティリティを実装。
- 顧客データはサーバーコンポーネントで読み込み (`fs/promises`)、テンプレートJSONも解析。
- 顧客行・テンプレートなどの型定義（TypeScript interfaces）を整備。

### 3. UIコンポーネント実装
- Tailwindでヘッダー、フィルター、テーブル、統計カード、プレビュー等のコンポーネントを作成。
- `useState` / `useMemo` でフィルタリング・ソート・テンプレート差し込み処理を再実装。
- クリップボードコピー機能 (`navigator.clipboard.writeText`) とフェイルバック実装。
- ローカルストレージでの自社名などの保持はカスタムフックで対応。

### 4. 検証とチューニング
- 既存HTMLと挙動一致を確認（フィルター、ソート、コピー内容）。
- Tailwindクラスの調整やアクセシビリティの軽微な改善。
- `npm run lint` / `npm run build` / `npm run dev -- --port 3002` で動作確認。

### 5. ドキュメントと移行案内
- README更新（セットアップ方法、データ更新手順、3002番ポート起動方法）。
- 旧 `index.html` から今後の更新手順を明記し、必要であれば旧ファイルをアーカイブ。

## スケジュール目安
| フェーズ | 作業時間目安 | 備考 |
| --- | --- | --- |
| 1. セットアップ | 0.5日 | create-next-app + Tailwind初期化 |
| 2. データ層 | 0.5日 | Markdown→構造体化 |
| 3. UI実装 | 1.0日 | Tailwind UI + 状態管理 |
| 4. 検証 | 0.5日 | 機能確認 + lint/build |
| 5. ドキュメント | 0.25日 | README/運用手順 |

## リスクと対策
- **Markdown形式のまま扱うための文字エンコーディング** → Node.js 側で UTF-8 を前提とし、読み込み時に BOM 処理を実施。
- **ブラウザのクリップボード制限** → HTTPS/localhost以外で動作しない場合に備え、Fallback処理を保持。
- **データ拡張時の再ビルド必要性** → 今回は静的読込だが、将来的にAPI化/DB化を見据えてデータ層を抽象化。

## 次のアクション
1. Next.js プロジェクト作成と Tailwind 初期セットアップ。
2. Markdown 読込ユーティリティ＆型を実装。
3. UI/機能実装を段階的に移植。
4. 動作確認のうえ、3002番ポートでサーバー起動。

